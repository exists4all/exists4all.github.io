<!DOCTYPE html>
<html lang="en-us">
    <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RYNLQKXDCY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-RYNLQKXDCY');
    </script>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="generator" content="Hugo 0.128.2">

    
        <meta name="google-site-verification" content="FJeEV8Eq61e0o2MnOwH64y1WgBV42wPtjOS_Z8FZl4c" />
    

    

    
        
            <meta name="description" content="Important things that you should keep in mind before starting your kernel journey!" />
        

        
            <meta name="keywords" content="[Hyper Visor, VMware, Windows kernel development, Notes on kernel]" />
        

        
            <meta name="author" content="Exists4All" />
        

    


    <title>
        
            Before Start |
            Exists4All
        
    </title>

    


    
    

    
    


    
    


    
    


    
    

    


    
    

    

    

        
        


        
        


        <link
            rel="stylesheet"
            href="/css/index_d751713.min.c33e31e36698343dc458368c969e849132d12d4928b56dad50c0171f81fbce86a13522fabf2aef76391ff42a5b67df79b4233cfca5566cdcc4bd031889e09022.css"
            integrity="sha512-wz4x42aYND3EWDaMlp6EkTLRLUkotW2tUMAXH4H7zoahNSL6vyrvdjkf9CpbZ995tCM8/KVWbNzEvQMYieCQIg==" />
    


    
    

    

    

    

    
</head>



    <body>
        <header class="header">
    <div class="header_left">
        
    </div>

    <div class="header_middle">
        
            Before Start -
            Exists4All
        
    </div>
</header>



        <main>
            <aside class="sidebar">
    



    
    

    
    


    <ul class="section-tree">
        
            
                <li
                    
                        class="dir opened-dir"
                    >
                    <span class="dir-text"> Posts </span>

                    



    
    

    
    


    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="https://exists4all.github.io/posts/simpepecrypter/" title="./posts/simpepecrypter/">
                        SimpePECrypter
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://exists4all.github.io/posts/on_the_cryptoapi/" title="./posts/on_the_cryptoapi/">
                        On The Cryptoapi
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://exists4all.github.io/posts/simple_disk_serial_spoofer_part_1/" title="./posts/simple_disk_serial_spoofer_part_1/">
                        Simple Disk Serial Spoofer part 1
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://exists4all.github.io/posts/before_start/" title="./posts/before_start/">
                        Before Start
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
    </ul>


</aside>
<aside class="exapandable"></aside>


            
    <article class="main">
        <button
    class="sidebar-toggle-btn"
    type="menu"
    aria-expanded="false"
    aria-haspopup="true">
    <i class="bi bi-list"></i>
</button>



        <div class="title">
            <h1 class="title-header">
                Before Start
            </h1>

            <div class="author-date-readtime">
                

                    
                        <div class="author" title="Author">
                            <i class="bi bi-person"></i>
                            <a
                                href="/author/exists4all/"
                                class="cat-btn">
                                Exists4All
                            </a>
                        </div>
                    

                

                
                    <div class="date" title="Date">
                        <i class="bi bi-calendar3"></i>
                        <time
                            datetime="2024.03.17"
                            >2024.03.17
                        </time>
                    </div>
                

                
            </div>
        </div>

        <div class="article-meta">
            
                <div class="categories">
                    <i
                        class="bi bi-bookmarks"
                        title="Categories"></i>
                    
                        <a
                            href="/categories/windows/"
                            class="cat-btn">
                            Windows
                        </a>
                    
                        <a
                            href="/categories/kernel/"
                            class="cat-btn">
                            Kernel
                        </a>
                    
                        <a
                            href="/categories/driver-development/"
                            class="cat-btn">
                            Driver Development
                        </a>
                    
                        <a
                            href="/categories/note/"
                            class="cat-btn">
                            Note
                        </a>
                    
                </div>
            

            
                <div class="tags">
                    <i
                        class="bi bi-tags"
                        title="Tags"></i>
                    
                        <a
                            href="/tags/hyper-visor/"
                            class="tag-btn">
                            Hyper Visor
                        </a>
                    
                        <a
                            href="/tags/vmware/"
                            class="tag-btn">
                            VMware
                        </a>
                    
                        <a
                            href="/tags/windows-kernel-development/"
                            class="tag-btn">
                            Windows kernel development
                        </a>
                    
                        <a
                            href="/tags/notes-on-kernel/"
                            class="tag-btn">
                            Notes on kernel
                        </a>
                    
                </div>
            

            
                <div class="breadcumb">
                    <i class="bi bi-folder"></i>
                    
    
    




<a href="https://exists4all.github.io/" class="bread-btn">
    
        <i class="bi bi-house-fill"></i>
    

    
        Home
    
</a>




    /



<a href="https://exists4all.github.io/posts/" class="bread-btn">
    

    
        Posts
    
</a>




    /



<a href="https://exists4all.github.io/posts/before_start/" class="bread-btn">
    

    
        Before Start
    
</a>

                </div>
            

            
        </div>

        
            <nav id="TableOfContents"></nav>
        


        <div class="content">
            
                <p>Welcome to my kernel programming tutorial document. Be sure to read these notes before starting.</p>
<hr>
<ol>
<li>
<p>Kernel programming is not anything like user mode programming, information about its structure is very limited and most of the time you have to dig very deep into MSDN documentation to understand where you need to start.</p>
</li>
<li>
<p>Kernel mode codes have to be perfect, any flaw in them will cause serious problems and most of the time lead to BSOD ( blue screen of death) if they are not treated perfectly.</p>
</li>
<li>
<p>For the structure without any documentation you have to do the dirty work yourself and RE (reverse engineering) OS files yourself and extract documentation yourself which I will explain later in this document.</p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/">This page</a> is your main resource, stick to it and spend most of your hours here. I highly suggest going through the Kernel-Mode <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/install/guid-devinterface-volume">Driver Architecture Design Guide</a>. Read it slowly and try to digest it and practice alongside it and get back to it when you need to. For kernel mode API, always go <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/">here</a> first.</p>
</li>
<li>
<p>Sometimes you want to do something in kernel mode and you just do not know which function will do the job for you. In such situations I highly recommend you to visit <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/">API reference docs for Windows Driver Kit</a> and try to go to the logical part of it and read APIs descriptions. It will help you a lot. I will show you with some real examples how to do this.</p>
</li>
<li>
<p>Always and always treat every single warning as an error and fix it.</p>
</li>
<li>
<p>Usually you won&rsquo;t find examples for kernel functions. The best solution is read documentation in your IDE header files and try to figure it out yourself. It’s not easy at first but it will get easier when you get used to kernel functions. You can use <a href="https://cpp.hotexamples.com/">this</a> website to see if there is an example of a key function that you are looking for, you can also check github as well.</p>
</li>
<li>
<p>You need a virtual machine to practice kernel programming. I also recommend <a href="https://www.triplefault.io/2017/07/setting-up-kernel-debugging-using.html">this(also saved in case of broken link in same directory)</a> website for windbg and virtual machine synchronization.</p>
</li>
<li>
<p>In order to be able to compile kernel mode codes, you have to download visual studio C++ workstation, windows SDK and finally windows WDK and install them in order respectively. Also I highly recommend installing all of them in the default path, because I changed the default paths and that led to failure. Do it at your own risk.</p>
</li>
<li>
<p>I suggest compiling code on your main OS and then running .sys on your VM.</p>
</li>
<li>
<p>You can alos use <a href="https://github.com/microsoft/Windows-driver-samples/blob/main/storage/class/disk/src/disk.c">Windows-driver-samples</a> to find out what you need to do.</p>
</li>
<li>
<p>You need to run your drivers on the test mode to disable driver signature check to enable test mode open cmd as administrator and run below instruction and then reboot your system you have to see test mode on the right corner side of your windows after it. If you want to run you code without test mode you have to use other signed driver vulnerability which we will discuss later on you can read more about it <a href="https://repnz.github.io/posts/abusing-signed-drivers/">here</a> and <a href="https://j00ru.vexillium.org/2010/06/insight-into-the-driver-signature-enforcement/">here</a>  and also <a href="https://j00ru.vexillium.org/2012/11/defeating-windows-driver-signature-enforcement-part-1-default-drivers/">here</a>. (pages saved in case of broken link)</p>
</li>
</ol>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="%20%20%20%20bcdedit%20/set%20testsigning%20on">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <pre><code>    bcdedit /set testsigning on</code></pre>
    
</div>
<ol start="13">
<li>
<p>Remember that some specific hardware on your virtual machine will be treated differently, If you want to work with real hardware the best option is use a real computer and debug it over the network with windbg.</p>
</li>
<li>
<p>For some functions you are going to use internal .lib functions and when you use the header file you will get a linker error. For example <strong>FltGetVolumeGuidName</strong> function, you will get linker error if you just include <strong>fltkernel.h</strong> in your source code to fix this problem you find <strong>.lib</strong> name which is <strong>FltMgr.lib</strong> in our case then head to <strong>Linker-&gt;Input-&gt;Additional</strong> Dependencies and add <strong>$(DDK_LIB_PATH)\fltMgr.lib</strong> to resolve issue.</p>
</li>
<li>
<p>After working and testing VMWare and Hyper-V, I can say in my experience Hyper-V works much much better for Windows kernel experiments. I had multiple problems with VMWare in last few experiments. As a result, I am no longer using VMWare.</p>
</li>
</ol>
<hr>

            
        </div>
    </article>

        </main>

        <footer class="footer">
    <div class="footer-left">
        <ul class="social">
            
                <li>All Rights Reserved ®.</li>
            

            
                <li>Exists4All</li>
            

            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </ul>
    </div>

    <div class="footer-right">
        <ul class="control status clearfix">
            
                <li>
                    
                        Word Count:
                        686
                    
                </li>
            

            
            

            
                <li>en</li>
            

            
                <li>
                    <a href="https://gohugo.io" class="btn" target="_blank"
                        >Hugo: 0.128.2</a
                    >
                </li>
            

            
                <li>
                    <a
                        href="https://github.com/JingWangTW/dark-theme-editor"
                        class="btn"
                        target="_blank"
                        >Theme: dark-theme-editor</a
                    >
                </li>
            

            
                <li>
                    
                        Last modified: &nbsp;
                        <time>
                            Mar 17 2024 06:36:21
                        </time>
                    
                </li>
            

            
                <li title="">
                    
                </li>
            
        </ul>
    </div>
</footer>

    </body>

    























    
    


    
    


    <script
        type="text/javascript"
        src="/js/index_d751713.min.5eeb120f16ea146352725c420364f87befead45f678142b8f0ffbef024646931fbc06bff07a7bd6cb57fa2f8cd8a21ba6a4ee5a278ec32303a378bc1cd17f246.js"
        integrity="sha512-XusSDxbqFGNSclxCA2T4e&#43;/q1F9ngUK48P&#43;&#43;8CRkaTH7wGv/B6e9bLV/ovjNiiG6ak7lonjsMjA6N4vBzRfyRg=="></script>














<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />




</html>
